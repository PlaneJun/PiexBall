# ä¸€ã€ä¿æŠ¤æ¨¡å¼

# 1ã€ä¿æŠ¤æ¨¡å¼ç®€ä»‹

CPUåˆ†æœ‰ï¼š`å®æ¨¡å¼`ã€`ä¿æŠ¤æ¨¡å¼`ã€`è™šæ‹Ÿ8086`æ¨¡å¼ï¼Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿéƒ½è¿è¡Œåœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ã€‚

ä¿æŠ¤æ¨¡å¼ä¸»è¦æ˜¯ç”¨æ¥ä¿æŠ¤å¯„å­˜å™¨ã€æ•°æ®ç»“æ„ã€æŒ‡ä»¤ï¼Œå®é™…ä¸Šä¹Ÿå°±æ˜¯ä¿æŠ¤å¯„å­˜å™¨ï¼Œå› ä¸ºcpuçš„æ•°æ®éƒ½å­˜æ”¾åœ¨å¯„å­˜å™¨ä¸­ã€‚

ä¿æŠ¤æ¨¡å¼çš„ç‰¹ç‚¹ï¼šæ®µå’Œé¡µã€‚

- å®æ¨¡å¼ï¼š16ä½ç³»ç»ŸDOSï¼Œè®¿é—®çš„éƒ½æ˜¯ç‰©ç†åœ°å€ï¼Œä¸å®‰å…¨ã€‚
- ä¿æŠ¤æ¨¡å¼ï¼šå°†ç‰©ç†åœ°å€éš”é˜‚åï¼Œä½¿ç”¨ä¸€ç§çº¿æ€§çš„è™šæ‹Ÿåœ°å€æ¥è®¿é—®ï¼Œç›¸å¯¹å®æ¨¡å¼æ¥è¯´æ¯”è¾ƒå®‰å…¨ã€‚å¹¶ç”¨æ®µå’Œé¡µçš„ç‰¹ç‚¹æ¥ç»´æŠ¤è™šæ‹Ÿåœ°å€ã€‚

ä¿æŠ¤æ¨¡å¼å…·ä½“èµ„æ–™å¯ä»¥åœ¨Â Intelç™½çš®ä¹¦ç¬¬ä¸‰å·Â ä¸­æŸ¥çœ‹ã€‚

# 2ã€æ®µå¯„å­˜å™¨

## 2.1Â æ®µé€‰æ‹©å­

CPUä¸€å…±æœ‰å…«ä¸ªæ®µå¯„å­˜å™¨ï¼šES CS SS DS FS GS LDTR TRÂ ï¼ŒODå¯è§å‰6ä¸ªï¼Œä½†GSæ®µå¯„å­˜å™¨windowså¹¶æœªä½¿ç”¨ï¼ˆ32ä½ä¸‹ï¼‰ã€‚

![Untitled.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled.jpeg)

å¦‚æœè¿è¡Œåœ¨å®æ¨¡å¼ä¸‹ï¼Œåˆ™åªæœ‰å‰å››ä¸ªæœ‰ç”¨ã€‚

å¦‚æœæ˜¯64ä½ï¼Œåˆ™ä½¿ç”¨GSè€Œä¸æ˜¯FSã€‚

å½“æ‰§è¡Œä¸‹åˆ—æ±‡ç¼–ä»£ç æ—¶

```nasm
movÂ [0x12345678],eax
```

å®é™…ä¸Šcpuæ‰€â€œçœ‹åˆ°çš„â€ä»£ç å¦‚ä¸‹ï¼š

```nasm
mov dword ptr ds:[0x12345678],eax
//ds.base+0x12345678
//cs.base+0x12345678
//ss.base+0x12345678
```

ğŸ’¡ dsæ®µå¯„å­˜å™¨é€šå¸¸æ—¶ç”¨æ¥å­˜æ”¾è¦è®¿é—®æ•°æ®çš„æ®µåœ°å€ã€‚csæ®µå¯„å­˜å™¨è¡¨ç¤ºè¦æ‰§è¡Œçš„ä»£ç ã€‚ssæ®µå¯„å­˜å™¨è¡¨ç¤ºå †æ ˆçš„æ®µåœ°å€ã€‚[â€¦]åˆ™è¡¨ç¤ºä¸€ä¸ªå†…å­˜å•å…ƒï¼Œæ¯”å¦‚ds:[1],cs:[1],ss:[1]ã€‚â€”â€”ç‹çˆ½ã€Šæ±‡ç¼–è¯­è¨€ã€‹

æ®µå¯„å­˜å™¨ç»“æ„ï¼šÂ å…±96ä½ï¼ŒÂ 16ä½å¯è§ï¼Œ80ä½ä¸å¯è§ã€‚

![Untitled 1.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_1.jpeg)

```c
struct SegMen{    WORD Selector;//16ä½    WORD Attributes;//16ä½    DWORD Base;//32ä½    DWORD Limit;//32ä½};
```

è¯»æ®µå¯„å­˜å™¨æŒ‡ä»¤ï¼šmov ax,es **åªèƒ½è¯»16ä½**ï¼ˆå¯è§éƒ¨åˆ†ï¼‰

å†™æ®µå¯„å­˜å™¨æŒ‡ä»¤ï¼šmov ds,ax **å†™äº†96ä½çš„**ã€‚

æ®µå¯„å­˜å™¨å¯ä»¥ç”¨movæŒ‡ä»¤è¯»å†™ï¼Œä½†æ˜¯LDTRå’ŒTRé™¤å¤–ã€‚

åŠ è½½æ®µæè¿°ç¬¦è‡³æ®µå¯„å­˜å™¨çš„æŒ‡ä»¤å…±æœ‰ä¸‰ç§ï¼š

- mov ss,axÂ ä½¿ç”¨movæŒ‡ä»¤
- **les lss lds lfs lgs**ä¿®æ”¹å¯¹åº”çš„æ®µå¯„å­˜å™¨
- csä¸èƒ½é€šè¿‡ä¸Šè¿°æŒ‡ä»¤æ”¹å˜ï¼Œå¦åˆ™ä¼šå¯¼è‡´EIPçš„æ”¹å˜ï¼Œå¿…é¡»ä¿è¯csä¸eipä¸€èµ·æ”¹ã€‚åæ–‡ä¼šè®²è§£å¦‚ä½•ä¿®æ”¹CSå¹¶åœ¨éœ€è¦æ—¶æå‡æƒé™ã€‚

å…¶ä¸­é€‰æ‹©å­(Selector)æœ‰å¦‚ä¸‹ç»“æ„ï¼š

![Untitled.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled.png)

æ‰“å¼€ODï¼Œéšä¾¿åŠ è½½ä¸€ä¸ªç¨‹åºå¯ä»¥çœ‹åˆ°æ®µå¯„å­˜å™¨å¯¹åº”çš„é€‰æ‹©å­ã€‚

![Untitled 2.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_2.jpeg)

ä»¥fsçš„é€‰æ‹©å­ä¸ºä¾‹è¿›è¡Œè§£æï¼š

```c
fs=0x0053 => 0000 0000 0101 0011
ç”±äºå‰é¢ä¸¤ä¸ªå­—èŠ‚ä¸º0ï¼Œå› æ­¤å•ç‹¬æ‹¿åé¢ä¸¤ä¸ªå­—èŠ‚è®²è§£ã€‚
0101 0011
æ ¹æ®ä¸Šé¢ç»™å‡ºçš„Selectorè¡¨å¯ä»¥å¯¹è¿™ä¸¤ä¸ªå­—èŠ‚åˆ’åˆ†ã€‚
01010 0 11

å€¼Â Â  Â Â |Â  Â Â å«ä¹‰
- ------------------------------------------------
01010Â Â |Â  Â Â æ¬²æŸ¥è¡¨çš„ç´¢å¼•å·,æ­¤å¤„ä¸ºåè¿›åˆ¶5
0Â  Â  Â Â |Â  Â Â æ¬²æŸ¥å“ªä¸€å—è¡¨;0->GDT 1->LDT
11Â Â  Â Â |Â  Â Â å“ªä¸€ç¯çš„æƒé™(RPL),æ­¤å¤„ä¸ºåè¿›åˆ¶3,å› æ­¤ä¸º3ç¯
æ ¹æ®å…¬å¼Â addr = GDT + 8 * indexè®¡ç®—åå¯å¾—åˆ°fsçš„æ®µæè¿°ç¬¦
addr = 0xfffff88004590000 + 8 * 5 = 0xfffff88004590028

2: kd> dq fffff88004590028
fffff880`04590028Â Â **00cff300`0000ffff** 0020fb00`00000000
fffff880`04590038Â Â 00000000`00000000 04008b58`f0000067
fffff880`04590048Â Â 00000000`fffff880 ff40f3fd`f000bc00
fffff880`04590058Â Â 00000000`00000000 00cf9a00`0000ffff
fffff880`04590068Â Â 00000000`00000000 00000000`00000000
fffff880`04590078Â Â 00000000`00000000 00000000`00000000
fffff880`04590088Â Â 00000000`00000000 00000000`00000000
fffff880`04590098Â Â 00000000`00000000 00000000`00000000
```

> GDTï¼šå…¨å±€æè¿°è¡¨ï¼ˆGlobal Description Tableï¼‰ï¼Œåœ¨æ“ä½œç³»ç»ŸåŠ è½½å®Œæ¯•åå°±å­˜åœ¨çš„ä¸€å¿«å†…å­˜ã€‚å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€ä¸ªå…ƒç´ å°±æ˜¯ä¸€ä¸ªæè¿°ç¬¦ï¼Œå¤šä¸ªç»„åˆä¸€èµ·å°±æ„æˆäº†å…¨å±€æè¿°ç¬¦è¡¨ã€‚è€Œæ¯ä¸€ä¸ªæè¿°ç¬¦å…±64ä½ï¼ŒåŒ…å«äº†ä»¥ä¸‹çš„è¿™äº›ä¿¡æ¯ï¼šæ®µåŸºå€ã€æ®µé•¿åº¦ã€å±æ€§ã€‚æ®µå¯„å­˜å™¨é€šè¿‡è§£æé€‰æ‹©å­åå¾—åˆ°ç´¢å¼•ååœ¨GDTä¸­è·³è½¬è·å–å¯¹åº”æè¿°ç¬¦ã€‚
> 

> LDTï¼šå±€éƒ¨æè¿°è¡¨ï¼ˆLocal Description Tableï¼‰ï¼Œä¸GDTåŠŸèƒ½ä¸€è‡´ï¼Œä½†ä¸èƒ½å•ç‹¬å­˜åœ¨ï¼Œåªèƒ½åµŒå¥—åœ¨GDTä¸­ã€‚
> 
- **windbgè·å–GDT**

GDTå¯ä»¥ä½¿ç”¨windbgçš„å‘½ä»¤å¯ä»¥æŸ¥çœ‹gdtè¡¨çš„åœ°å€ï¼š

```c
gdtrå¯„å­˜å™¨ï¼ˆwindbgä¼ªå¯„å­˜å™¨ï¼Œæ˜¯windbgé€šè¿‡sgdt lgdtæŒ‡ä»¤è·å–çš„ï¼Œä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ï¼Œæ‰æ¨¡æ‹Ÿäº†ä¸€ä¸ªå¯„å­˜å™¨å«gdtrï¼Œå®é™…æ˜¯æ²¡æœ‰è¿™ä¸ªå¯„å­˜å™¨çš„ï¼‰Â :
å­˜ä¸¤ä¸ªå€¼ï¼Œä¸€ä¸ªæ˜¯GDTè¡¨åœ¨å“ªé‡Œï¼Œä¸€ä¸ªæ˜¯GDTè¡¨æœ‰å¤šå¤§Â Â Â 48ä½Â Â æœ‰32ä½å­˜å‚¨åœ¨å“ªé‡Œï¼Œ16ä½å­˜å‚¨å¤§å°
r gdtrÂ Â ræŸ¥çœ‹gdtrå¯„å­˜å™¨çš„åœ°å€
r gdtlÂ Â ræŸ¥çœ‹gdtrå¯„å­˜å™¨çš„å¤§å°Â Â éƒ½æŸ¥gdtr
ddÂ Â xxxxÂ Â  Â  Â Â 4å­—èŠ‚æŸ¥çœ‹å†…å­˜
dqÂ Â XXXXÂ Â  Â  Â Â 8å­—èŠ‚æŸ¥çœ‹å†…å­˜
dqÂ Â xxxx LnumÂ  Â Â æŸ¥çœ‹å›ºå®šæ•°é‡å…ƒç´ çš„å†…å­˜
```

![Untitled 3.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_3.jpeg)

- **r3ä»£ç è·å–GDT**

é€šè¿‡æŒ‡ä»¤sgdtè·å–ã€‚å…¶ä¸­å…±è·å–åˆ°6ä¸ªå­—èŠ‚,å‰ä¸¤ä¸ªå­—èŠ‚ä½gdtå¯„å­˜å™¨çš„å¤§å°,åé¢å››ä¸ªå­—èŠ‚ä¸ºgdtçš„åœ°å€ã€‚

![Untitled 1.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_1.png)

```c
#include "stdafx.h"
#include<stdlib.h>

int _tmain(int argc, _TCHAR* argv[])
{
	unsigned char var[6]={0};
	_asm{
		sgdt var
	}
	printf("%x,%x\n",*(unsigned int*)&var[2],*(unsigned short*)&var[0]);
	return 0;
}
```

![Untitled 2.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_2.png)

## 2.2Â æ®µæè¿°ç¬¦

æ®µæè¿°ç¬¦æœ‰å¦‚ä¸‹ç»“æ„ï¼š

![Untitled 3.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_3.png)

å°†`0x00cff300`0000ffff`è¿›è¡Œæ‹†åˆ†å¯å¾—åˆ°å¦‚ä¸‹

```c
base:0x00000000
attr:0x0cf3(å‰é¢çš„0æ˜¯è¡¥é½2å­—èŠ‚)
limit:0xfffff(å‰é¢çš„0æ˜¯è¡¥é½4å­—èŠ‚)

attrçš„å±æ€§åˆå¯ä»¥ç»†åˆ†å¦‚ä¸‹ï¼š
0xc = 1100
----------------------------
G:1;1->limitä»¥4kå¯¹é½,limit = ( limit + 1 ) * 4096 - 1Â  Â Â 0->å­—èŠ‚å¯¹é½,limit = limit
D/B:1
0:0
AVL:0

0xf3 = 1111 0011
-----------------------------
P:1
DPL:11
S:1
Type:0011(3)
```

- **Gä½**
    
    æ®µå¯¹é½ç²’åº¦ã€‚Â ä¹Ÿå°±æ˜¯å†³å®šäº†Limitå¤§å°çš„ä¸€ä¸ªä½ã€‚
    
    åœ¨ä¸Šæ–‡å¡«å……æ®µå¯„å­˜å™¨éšè—éƒ¨åˆ†æ—¶ï¼ŒLimitåœ¨æè¿°ç¬¦ä¸­åªæœ‰5ä¸ª16è¿›åˆ¶ä½è¡¨ç¤ºï¼Œå‰©ä¸‹çš„3ä¸ª16è¿›åˆ¶ä½å°±éœ€è¦çœ‹Gä½ã€‚
    
    å½“Gä¸º0æ—¶ï¼Œæ•´ä¸ªæ®µå°†ä»¥å­—èŠ‚å¯¹é½ï¼ŒLimitå¤§å°å•ä½ä¸ºå­—èŠ‚ï¼Œæ‰€ä»¥ç²¾ç¡®åˆ°1ã€‚Limitç›´æ¥å°±æ˜¯æ®µé•¿ã€‚æ®µå¯„å­˜å™¨ä¸­çš„Limité«˜ä½è¡¥0ã€‚
    
    å½“Gä¸º1æ—¶ï¼Œæ•´ä¸ªæ®µå°†ä»¥4KBå¯¹é½ï¼ŒLimitå¤§å°å•ä½ä¸º4KBï¼Œæ‰€ä»¥æ®µçš„æœ«å°¾å¤„ä¸€å®šæ˜¯ä»¥FFFç»“å°¾ã€‚æ®µå¯„å­˜å™¨ä¸­çš„Limitä½ä½è¡¥FFFã€‚
    
- **D/Bä½**
    
    **=0**è¡¨ç¤ºæ˜¯16ä½çš„å•ä½,**=1**è¡¨ç¤º32ä½çš„å•ä½ã€‚
    
    å¦‚æœæ˜¯ä»£ç æ®µçš„æè¿°ç¬¦,é‚£ä¹ˆç§°ä¸ºD;å¦‚æœæ˜¯æ•°æ®æ®µçš„æè¿°ç¬¦,ç§°ä¸ºBã€‚
    
    å¤§æ®µæˆ–è€…å°æ®µï¼Œåˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š
    
    **å¯¹CSæ®µæ¥è¯´ï¼š**
    
    ä¸º1æ—¶ï¼Œé»˜è®¤ä¸º32ä½å¯»å€ã€‚
    
    ä¸º0æ—¶ï¼Œé»˜è®¤ä¸º16ä½å¯»å€ã€‚
    
    å‰ç¼€67æ”¹å˜å¯»å€æ–¹å¼ã€‚
    
    **å¯¹SSæ®µæ¥è¯´ï¼š**
    
    ä¸º1æ—¶ï¼Œéšå¼å †æ ˆè®¿é—®æŒ‡ä»¤ï¼ˆPUS H POP CALL RETNç­‰ï¼‰ä¿®æ”¹çš„æ˜¯32ä½å¯„å­˜å™¨ESP
    
    ä¸º0æ—¶ï¼Œéšå¼å †æ ˆè®¿é—®æŒ‡ä»¤ï¼ˆPUSH POP CALL RETNç­‰ï¼‰ä¿®æ”¹çš„æ˜¯16ä½å¯„å­˜å™¨SP
    
    å¯¹äºå‘ä¸‹æ‰©å±•çš„æ•°æ®æ®µï¼š
    
    ä¸º1æ—¶ï¼Œæ®µä¸Šé™å¤§å°ä¸º4GB(2çš„32æ¬¡æ–¹)ã€‚Â ä¸º0æ—¶Â æ®µä¸Šé™å¤§å°ä¸º64KB(2çš„16æ¬¡æ–¹)ã€‚
    
    ![Untitled 4.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_4.png)
    
- Pä½
    
    æœ‰æ•ˆä½Â 1ï¼šæè¿°ç¬¦æœ‰æ•ˆÂ 0ï¼šæè¿°ç¬¦æ— æ•ˆ
    
    å½“æè¿°ç¬¦æ— æ•ˆæ—¶ï¼Œä»»ä½•å°è¯•åŠ è½½è¯¥æè¿°ç¬¦ã€è®¿é—®è¯¥æè¿°ç¬¦å¯¹åº”çš„æ®µé—´åœ°å€éƒ½ä¼šæŠ¥é”™ã€‚
    
- **DPLä½**
    
    èƒ½è®¿é—®æ®µæè¿°ç¬¦çš„æƒé™ã€‚
    
    ğŸ’¡ DPLã€CPLã€RPLçš„åŒºåˆ«åœ¨äºï¼ŒDPLæ˜¯æ®µæè¿°ç¬¦çš„æƒé™,å±äºå›ºå®šä¸”é»˜è®¤ã€‚RPLæ˜¯æ®µå¯„å­˜å™¨çš„æƒé™ï¼ŒCRLåŒæ ·æ˜¯æ®µå¯„å­˜å™¨çš„æƒé™,ä½†ä¸RPLåŒºåˆ«å°±æ˜¯CRLæŒ‡çš„æ˜¯å½“å‰ä»£ç æ‰§è¡Œçš„æ—¶å€™æ‰€è®¿é—®æ®µå¯„å­˜å™¨çš„æƒé™ã€‚ mov eax,dword ptr ds:[0x12345678]Â ;æ­¤æ—¶CRLæŒ‡çš„æ˜¯dså¯„å­˜å™¨çš„æƒé™,å…¶ä»–å¯„å­˜å™¨çš„æƒé™ç§°ä¸ºRPL. **æ€»ä¹‹,ç”¨å“ªä¸ªæ®µå¯„å­˜å™¨,é‚£ä¸ªå¯„å­˜å™¨çš„æƒé™å°±å«åšCRLã€‚å¸¸è§„æƒ…å†µä¸‹,ä»£ç çš„æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šç”¨åˆ°CSå’ŒSSæ®µå¯„å­˜å»,æ‰€ä»¥è¿™ä¸¤ä¸ªæ®µå¯„å­˜å™¨ç§°ä¸ºCRL,å…¶ä»–çš„å«åšRPLã€‚**
    
- Sä½
    
    æè¿°ç¬¦ç±»å‹ä½ã€‚Â ä¸º0æ—¶ï¼Œæ˜¯**ç³»ç»Ÿæ®µæè¿°ç¬¦**ã€‚Â ä¸º1æ—¶ï¼Œæ˜¯**ä»£ç æˆ–æ•°æ®æ®µæè¿°ç¬¦**ã€‚å…·ä½“ç±»å‹éœ€è¦æ­é…typeå±æ€§æ¥åˆ¤æ–­ã€‚
    
- Typeä½
    
    ç”±Sä½å†³å®šäº†å…·ä½“æ˜¯ä»£ç æ®µè¿˜æ˜¯æ•°æ®æ®µæè¿°ç¬¦
    
    - **å½“S=1,typeè¡¨ç¤ºä¸ºæ•°æ®æ®µçš„æè¿°**
    
    > æ•°æ®æ®µï¼š Aä½ï¼šæ•°æ®æ®µæ˜¯å¦è¢«è®¿é—®è¿‡ä½ï¼Œè®¿é—®è¿‡ä¸º1ï¼Œæœªè®¿é—®è¿‡ä¸º0Â Â æ®µæè¿°ç¬¦æ˜¯å¦è¢«åŠ è½½è¿‡ Wä½ï¼šæ•°æ®æ®µæ˜¯å¦å¯å†™ä½ï¼Œå¯å†™ä¸º1ï¼Œä¸å¯å†™ä¸º0 Eä½ï¼šå‘ä¸‹æ‰©å±•ä½ï¼Œ0å‘ä¸Šæ‰©å±•ï¼šæ®µå¯„å­˜å™¨.base+limitåŒºåŸŸå¯è®¿é—®ã€‚1å‘ä¸‹æ‰©å±•ï¼šé™¤äº†base+limitä»¥å¤–çš„éƒ¨åˆ†å¯è®¿é—®ã€‚
    > 
    
    > ä»£ç æ®µï¼š Aä½ï¼šä»£ç æ®µæ˜¯å¦è¢«è®¿é—®è¿‡ä½ï¼Œè®¿é—®è¿‡ä¸º1ï¼Œæœªè®¿é—®è¿‡ä¸º0Â Â æ®µæè¿°ç¬¦æ˜¯å¦è¢«åŠ è½½è¿‡ Rä½ï¼šä»£ç æ®µæ˜¯å¦å¯è¯»ä½ï¼Œå¯è¯»ä¸º1ï¼Œä¸å¯è¯»ä¸º0ã€‚(ä½†Rä½ä¸º0,ä»£ç æ®µç…§æ ·å¯ä»¥è¯») Cä½ï¼šä¸€è‡´ä½ã€‚1ï¼šä¸€è‡´ä»£ç æ®µ(0ç¯çš„å‡½æ•°åœ¨3ç¯å¯ä»¥è°ƒç”¨)ã€‚Â Â Â 0ï¼šéä¸€è‡´ä»£ç æ®µ(å„è°ƒå„çš„)
    > 
    
    ![Untitled 5.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_5.png)
    
    # é’ˆå¯¹Eä½çš„ç†è§£ä¸å®éªŒï¼š
    
    ![å·¦è¾¹ä¸ºå‘ä¸Šæ‰©å±•,å³è¾¹ä¸ºå‘ä¸‹æ‰©å±•ã€‚çº¢è‰²ä»£è¡¨å¯ä»¥è®¿é—®,ç»¿è‰²ä¸å¯è®¿é—®](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_6.png)
    
    å·¦è¾¹ä¸ºå‘ä¸Šæ‰©å±•,å³è¾¹ä¸ºå‘ä¸‹æ‰©å±•ã€‚çº¢è‰²ä»£è¡¨å¯ä»¥è®¿é—®,ç»¿è‰²ä¸å¯è®¿é—®
    
    `Tip:æ®µæè¿°ç¬¦æœ‰æ²¡æœ‰4G,é¦–å…ˆæ˜¯çœ‹Eä½çš„æ‹“å±•æ–¹å‘,å…¶æ¬¡æ˜¯çœ‹Baseå’Œlimitä¹‹é—´çš„å¤§å°ã€‚`
    
    é¦–å…ˆæ„é€ ä¸€æ¡æ®µæè¿°ç¬¦.
    
    ```bash
    00cff700`0000ffff
    
    base:00000000 
    attr:0cf7 
    limit:fffffÂ Â Â ;ç”±äºGä½æ˜¯1æ‰€ä»¥è¿™é‡Œå®é™…ä¸º(0xfffff+1) * 0x1000 - 1 = 0xFFFFFFFF
    
    Eä½:0111,**å‘ä¸‹æ‰©å±•**
    ```
    
    é€šè¿‡windbgçš„`e[b|d|D|f|p|q|w]Â addressÂ [Values]`æŒ‡ä»¤å¯ä»¥ä¿®æ”¹GDTä¸­ä¿å­˜çš„æ®µæè¿°ç¬¦ã€‚ä¿®æ”¹8003f090(GDTR = 8003f000),ç„¶åè¾“å‡ºgdtæŸ¥çœ‹å‰20ä¸ªæè¿°è¡¨,`dq address l20`ã€‚(æ³¨æ„æ˜¯å°å†™L,ä¸æ˜¯æ•°å­—1)ã€‚
    
    ![Untitled 7.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_7.png)
    
    ## æµ‹è¯•ä»£ç 1
    
    ---
    
    ```c
    //code1:
    #include "stdafx.h"
    unsigned char var = 0; //å…¨å±€å˜é‡
    int _tmain(int argc, _TCHAR* argv[])
    {
    	_asm{
    		mov ax,0x93 //10010 011 -> index = 18 * 8 = 144 (0x90)
    		mov ds,ax
    		mov dword ptr ds:[var],0x20
    	}
    	printf("%X\n",var);
    	return 0;
    }
    ```
    
    è¿è¡Œå‡ºé”™ã€‚
    
    ![Untitled 8.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_8.png)
    
    **åˆ†æï¼š**å¼‚å¸¸æ–­åœ¨äº†èµ‹å€¼varçš„åœ°æ–¹ã€‚é¦–å…ˆåœ¨æè¿°ç¬¦ä¸­atträ¸º0x0cf7,Type=0111è¡¨ç¤ºä¸ºå‘ä¸‹æ‰©å±•ã€å¯è¯»å†™ã€å·²è®¿é—®ã€‚æ ¹æ®ä¸Šå›¾å¯çŸ¥,å¦‚æœEä½ä¸ºå‘ä¸‹æ‰©å±•,åˆ™base+limitè¿™æ®µåŒºåŸŸæ˜¯æ— æ³•è®¿é—®çš„ã€‚å›åˆ°ä»£ç ä¸­å¯ä»¥çœ‹åˆ°å˜é‡varä¸ºå…¨å±€å˜é‡,é€šå¸¸æƒ…å†µä¸‹æ•°æ®éƒ½æ˜¯å­˜æ”¾åœ¨æ•°æ®æ®µ,å³**dsæ®µ**ä¸­,å› æ­¤å˜é‡varçš„è™šæ‹Ÿåœ°å€å­˜æ”¾åœ¨base+limitä¸­,æ­¤æ—¶å› ä¸ºæ— æ³•è®¿é—®è¯¥åŒºåŸŸ,å› æ­¤åœ¨å†™æ•°æ®æ—¶å‘ç”Ÿäº†é”™è¯¯ã€‚**ä¿®å¤æ–¹æ³•ä¸ºå°†Eä½ä¿®æ”¹ä¸ºå‘ä¸Šæ‰©å±•(E=0)ï¼Œæˆ–è€…å°†limitä¿®æ”¹ä¸ºä¸€ä¸ªå°èŒƒå›´å€¼,ä½¿å¾—å…¶ä»–åŒºåŸŸçš„å†…å­˜å¯ä»¥è®¿é—®(åœ¨demo2å®ç°)ã€‚**
    
    ![Untitled 9.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_9.png)
    
    ![Untitled 10.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_10.png)
    
    å®éªŒæˆåŠŸ!
    
    ## æµ‹è¯•ä»£ç 2
    
    ---
    
    é¦–å…ˆå°†0x8003f090ä¿®æ”¹å›0x00cff700`0000ffffã€‚
    
    ```c
    #include "stdafx.h"
    int _tmain(int argc, _TCHAR* argv[])
    {
    	unsigned char var = 0; //å±€éƒ¨å˜é‡
    	_asm{
    		mov ax,0x93
    		mov ds,ax
    		mov dword ptr ds:[var],0x20
    	}
    	printf("%X\n",var);
    	return 0;
    }
    ```
    
    è¿è¡ŒåŒæ ·æŠ¥é”™ã€‚
    
    ![Untitled 11.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_11.png)
    
    **åˆ†æï¼š**éœ€è¦æ³¨æ„çš„æ˜¯ä¸­æ–­æ‰“åœ¨äº†printfä¸Š,è¯´æ˜æˆ‘ä»¬ä¸Šè¾¹çš„ASMä»£ç æ²¡é—®é¢˜!é‚£ä¹ˆä¸€ä¸ªæ–°é—®é¢˜æ¥äº†,ä¸ºä»€ä¹ˆdemo1ä¸­ä¸­æ–­æ‰“åœ¨äº†varèµ‹å€¼ä¸Š?è™½ç„¶æˆ‘ä»¬æ˜¾å¼ä½¿ç”¨äº†dsæ®µæ¥æè¿°å˜é‡var,ä½†ä»å­˜åœ¨ä¸€ä¸ªé—®é¢˜,**å˜é‡varå±äºå †æ ˆåœ°å€**,æ‰€ä»¥å®é™…ä¸Š`mov dword ptr ds:[var]`è¢«ç¼–è¯‘å™¨ç¿»è¯‘æˆäº†`mov dword ptr ss:[var]`
    
    ![Untitled 12.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_12.png)
    
    ![Untitled 13.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_13.png)
    
    å› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä¿®æ”¹ssæ®µ,æ‰€ä»¥ä¸Šé¢å¯¹ssæ®µçš„æ“ä½œæ²¡é—®é¢˜ã€‚æ ¹æ®å•æ­¥æ‰§è¡Œ,å¯ä»¥å‘ç°ä¸­æ–­çš„ä½ç½®æ˜¯printfå‡½æ•°ã€‚
    
    ![Untitled 14.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_14.png)
    
    æ ¹æ®æˆ‘ä»¬æ„é€ çš„æè¿°ç¬¦å¯çŸ¥,base=0,limitçš„èŒƒå›´ä¸º0xFFFFFFFF,ç„¶ååˆå±äºå‘ä¸‹æ‰©å±•,æ‰€ä»¥0x0-0xFFFFFFFFçš„åŒºåŸŸæ— æ³•è®¿é—®,printfä¸­å¿…ç„¶æœ‰ç”¨åˆ°dsæ®µçš„æ•°æ®,ä½†è¿™äº›æ•°æ®æœ‰æ²¡æœ‰è®¿é—®æƒé™,å› æ­¤è®¿é—®ä¸­æ–­äº†ã€‚**ä¿®å¤æ–¹æ³•ä¸ºå°†limitè®¾ç½®ä¸ºä¸€ä¸ªå¾ˆå°çš„èŒƒå›´,è¿™æ ·å…¶ä»–çš„åŒºåŸŸå°±å¯ä»¥è®¿é—®äº†ã€‚æ¯”å¦‚0x1FFFã€‚(00c0f700`00000001)**
    
    ![Untitled 15.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_15.png)
    
    ![Untitled 16.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_16.png)
    
    å®éªŒå®Œæˆ!
    
    - **å½“S=0,typeè¡¨ç¤ºä¸ºç³»ç»Ÿæè¿°**
        
        (å°äº8æ˜¯16ä½çš„ç³»ç»Ÿæè¿°,å¤§äº8æ˜¯32ä½)
        
        ![Untitled 17.png](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_17.png)
        

ä½¿ç”¨windbgçš„`dg segment`å‘½ä»¤å¯ä»¥å¿«é€ŸæŸ¥çœ‹æ®µå¯„å­˜å™¨å¯¹åº”çš„æ®µæè¿°ç¬¦ã€‚

![Untitled 4.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_4.jpeg)

![Untitled 5.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_5.jpeg)

## 2.3Â æ®µå¯„å­˜å™¨è¯æ˜

è¯»çš„æ—¶å€™åªèƒ½è¯»åˆ°16ä½(é€‰æ‹©å­)ï¼Œä½†å†™çš„æ—¶å€™å´å†™å…¥äº†96ä½ã€‚å¦‚ä½•è¯æ˜å‰©ä¸‹çš„80ä½æ˜¯å¦å­˜åœ¨ï¼Ÿ

![Untitled 6.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_6.jpeg)

- **Attributeæ¢æµ‹**

```c
int main(int argc,char* argv[]){
	int var = 0;
	__asm{
		mov ax,ssÂ  Â  Â  Â  Â  Â  Â  Â Â //sså¯è¯»å¯å†™
		mov ds,axÂ  Â  Â  Â  Â  Â  Â  Â Â //dså¯è¯»å¯å†™
		mov dword ptr ds:[var],eaxÂ  Â  Â  Â Â //dsæ­¤æ—¶ä¸ºssï¼Œä¸æŠ¥é”™ï¼Œè¯´æ˜ä¸¤ä¸ªæ®µå¯„å­˜å™¨æƒé™ç›¸åŒ
	}
}
```

```c
int main(int argc,char* argv[]){
	int var = 0;
		__asm{
			mov ax,csÂ  Â  Â  Â  Â  Â Â //cså¯è¯»å¯æ‰§è¡Œä¸å¯å†™
			mov ds,axÂ  Â  Â  Â  Â  Â Â //dså¯è¯»å¯å†™
			mov dword ptr ds:[var],eaxÂ  Â  Â  Â Â //dsæ­¤æ—¶ä¸ºcsï¼Œå†™å…¥æ—¶æŠ¥é”™ï¼Œè¯´æ˜Attributeå±æ€§å­˜åœ¨
	}
}
```

- **Baseæ¢æµ‹**

```c
int main(int argc,char* argv[]){
	int var = 0;
	__asm{
		mov ax,fsÂ  Â  Â  Â  Â  Â Â //fsÂ çš„Â baseä¸ºTEBÂ Â ç”¨dsç¼–è¯‘ä¸è¿‡å»
		mov gs,axÂ  Â  Â  Â  Â  Â Â //gsÂ çš„Â baseä¸º0
		mov eax,gs:[0]Â  Â  Â  Â Â //gsæ­¤æ—¶ä¸ºfsï¼Œå†™å…¥ä¸å‡ºé”™ï¼Œè¯´æ˜Baseå±æ€§å­˜åœ¨Â Â fs.base+0
		mov dword ptr gs:[var],eax
	}
}
```

- **Limitæ¢æµ‹**

```c
int main(int argc,char* argv[]){
	int var = 0;
	__asm{
		mov ax,fsÂ  Â  Â  Â  Â  Â Â //fsÂ çš„Â baseä¸ºTEBÂ Â ç”¨dsç¼–è¯‘ä¸è¿‡å»
		mov gs,axÂ  Â  Â  Â  Â  Â Â //gsÂ çš„Â baseä¸º0
		mov eax,gs:[0x1000]Â  Â  Â  Â Â //å†™å…¥å‡ºé”™ï¼Œè¶…è¿‡äº†fsçš„limitï¼Œè¯´æ˜Limitå±æ€§å­˜åœ¨Â fs.base+0x1000
		//mov eax,ds:[0x7FFDF000+0x1000]Â Â ä¸æŠ¥é”™
		mov dword ptr gs:[var],eax
	}
}
```

## 2.4Â æ®µå¯„å­˜å™¨æƒé™

åˆ©ç”¨lesæŒ‡ä»¤ä¿®æ”¹esæ®µå¯„å­˜å™¨ï¼Œä»£ç å¦‚ä¸‹

```c
#include "stdafx.h"
#include<stdlib.h>
int _tmain(int argc, _TCHAR* argv[])
{
	//0x12345678 = EAX
	//0x001b = ES
	unsigned char var[6]={0x78,0x56,0x34,0x12,0x1b,00};
	_asm{
		les eax,fword ptr ds:[var]Â //å› ä¸ºæ˜¯å†™å…¥6å­—èŠ‚,æ‰€ä»¥éœ€è¦æ˜¾å¼fwordèµ‹å€¼
	}
	/*
	_asm{
		mov ax,0x1b
		mov es,ax
	}
	/*
	return 0;
}
```

è¿è¡Œæ­£å¸¸ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š

![Untitled 7.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_7.jpeg)

ä¸Šé¢ä»£ç ä¸­å†™å…¥ESçš„å€¼ä½0x001b,å¯¹åº”äºŒè¿›åˆ¶ä½`0000 0000 0001 1011`,æŒ‰ç…§é€‰æ‹©å­ç»“æ„åˆ’åˆ†åå¾—åˆ°`0011 0 11`,æœ«å°¾ä¸¤ä½åè¿›åˆ¶ä¸º3,å³CRLä¸º3ç¯æƒé™ã€‚å½“å‰å®éªŒç¯å¢ƒåŒæ ·ä¸º3ç¯ï¼Œå› æ­¤ç¨‹åºæ­£å¸¸ã€‚æ­¤æ—¶å°†ä»£ç çš„0x001bä¿®æ”¹ä¸º0x0010,é‡æ–°è¿è¡ŒåæŠ¥é”™ã€‚

![Untitled 8.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_8.jpeg)

å› ä¸º0x0010æŒ‰ç…§é€‰æ‹©å­ç»“æ„åˆ’åˆ†å,å¾—åˆ°çš„CRLä¸º0,å±äº0ç¯æƒé™ã€‚CPUç”±äºä¿æŠ¤æœºåˆ¶,ä¸å…è®¸3ç¯ç¨‹åºè®¿é—®0ç¯ç¨‹åºçš„æ•°æ®ï¼Œå› æ­¤ç¨‹åºå‘ç”Ÿé”™è¯¯ã€‚åœ¨ä¿®æ”¹æ®µå¯„å­˜å™¨æ—¶éœ€è¦éµå®ˆ**CRL â‰¤ DRLã€‚**

---

> mov ds,ax
> 

```c
;æ‰§è¡Œæ­¥éª¤
;1ã€æ£€æŸ¥CS.CPL>=CS.DPL(æ˜¯å¦æœ‰æƒé™æ‰§è¡Œ,æ— æƒé™åˆ™ä¸­æ–­)
;2ã€æ£€æŸ¥dsæ˜¯å¦ç­‰äºax,å¦‚æœç›¸ç­‰åˆ™ä¸åšä»»ä½•å¤„ç†ã€‚å¦åˆ™æ¥ç€ç¬¬ä¸‰æ­¥
;3ã€æ£€æŸ¥axçš„DS.RPL>=DS.DPL(æ˜¯å¦æœ‰æƒé™æ‰§è¡Œ,æ— æƒé™åˆ™ä¸­æ–­)
;4ã€èµ‹å€¼æˆåŠŸ,åˆ·æ–°ç¼“å­˜ã€‚
```

## Demo1

```c
#include "stdafx.h"
int _tmain(int argc, _TCHAR* argv[])
{
	_asm{
		mov ax,0x20 //0x20è¡¨ç¤ºä¸º0ç¯æƒé™,å¯¹åº”æè¿°ç¬¦ä¸º00cff300`0000ffff -> DPL=3
		mov ds,ax
	}
	return 0;
};æ‰§è¡Œæ­¥éª¤
;1ã€æ£€æŸ¥CS.CPL>=CS.DPL(æ˜¯å¦æœ‰æƒé™æ‰§è¡Œ,æ— æƒé™åˆ™ä¸­æ–­)
;2ã€æ£€æŸ¥dsæ˜¯å¦ç­‰äºax,å¦‚æœç›¸ç­‰åˆ™ä¸åšä»»ä½•å¤„ç†ã€‚å¦åˆ™æ¥ç€ç¬¬ä¸‰æ­¥
;3ã€æ£€æŸ¥axçš„DS.RPL>=DS.DPL(æ˜¯å¦æœ‰æƒé™æ‰§è¡Œ,æ— æƒé™åˆ™ä¸­æ–­)
;4ã€èµ‹å€¼æˆåŠŸ,åˆ·æ–°ç¼“å­˜ã€‚
```

è¿è¡Œåæ²¡é—®é¢˜ã€‚å› ä¸ºCS.CPLâ‰¥CS.DPL,DS.RPLâ‰¥DS.DPL

## Demo2

é¦–å…ˆä¿®æ”¹`0x8003f090`ä¸º`0x00cf9300`0000ffff`å³0ç¯æƒé™ã€‚

![Untitled 9.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_9.jpeg)

```c
#include "stdafx.h"
int _tmain(int argc, _TCHAR* argv[])
{
	_asm{
		mov ax,0x93 //0x93è¡¨ç¤ºä¸º3ç¯æƒé™,å¯¹åº”æè¿°ç¬¦00cf9300`0000ffff -> DPL=0
		mov ds,ax
	}
	return 0;
}
```

è¿è¡Œåä¸­æ–­ã€‚

![Untitled 10.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_10.jpeg)

å› ä¸ºæ­¤æ—¶DS.RLP<DS.DPL(3ç¯è®¿é—®0ç¯æ•°æ®,ä¸åˆæ³•)ã€‚å°†ä»£ç è¿›è¡Œä¿®æ”¹å¦‚ä¸‹:

```c
#include "stdafx.h"
int _tmain(int argc, _TCHAR* argv[])
{
	_asm{
	mov ax,0x90 //0x90è¡¨ç¤ºä¸º0ç¯æƒé™,å¯¹åº”æè¿°ç¬¦00cf9300`0000ffff -> DPL=0
	mov ds,ax
	}
	return 0;
}
```

è¿è¡Œåä¾ç„¶æŠ¥é”™ã€‚

![Untitled 11.jpeg](%E4%B8%80%E3%80%81%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%209125e0c3a44a4d1c9a4f48e1572cac4b/Untitled_11.jpeg)

è™½ç„¶DS.RPLâ‰¥DS.DPL,ä½†æ˜¯CS.CPL<DS.RPL,å¯¼è‡´3ç¯ç©ºé—´æ— æ³•è®¿é—®0ç¯ç©ºé—´,æ‰€ä»¥ä¸­æ–­äº†ã€‚(ç†è®ºä¸Š,æŠŠCSã€SSã€DSçš„DPLã€CPLã€RPLéƒ½æ”¹æˆ0ç¯,å°±èƒ½ç›´æ¥åœ¨0ç¯æäº‹,ä½†æ˜¯CSå’ŒSSä¸å¥½æ”¹,éœ€è¦ç‰¹æƒæŒ‡ä»¤ã€‚)

- **æ€»ç»“:CS.CPL â‰¥ CS.DPL && DS.RPL â‰¥ DS.DPL && CS.CPL â‰¥ DS.RPLæœ€ç»ˆå¾—åˆ°**
- **CS.CPLâ‰¥CS.DPL && CS.CPLâ‰¥DS.DPL**

ğŸ’¡ ç”±äºCSæ˜¯ä»£ç æ®µå¯„å­˜å™¨,ä»£ç çš„æ‰§è¡Œå¿…å®šæ˜¯éœ€è¦ç”¨åˆ°å †æ ˆ,å› æ­¤CSå’ŒSSçš„CPLã€DPLã€RPLå¿…é¡»ä¸€è‡´ã€‚